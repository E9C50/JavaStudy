package leetcode;

import java.util.PriorityQueue;

public class LC1792_MaximumAveragePassRatio {
    private static class Tuple {
        public final Integer id;
        public final double delta;

        public Tuple(Integer id, double delta) {
            this.id = id;
            this.delta = delta;
        }
    }

    public double maxAverageRatio(int[][] classes, int extraStudents) {
        // 使用自定义比较器创建最大堆
        PriorityQueue<Tuple> maxHeap = new PriorityQueue<>((a, b) -> Double.compare(b.delta, a.delta));

        for (int i = 0; i < classes.length; i++) {
            double delta = ((double) (classes[i][0] + 1) / (classes[i][1] + 1)) - ((double) classes[i][0] / classes[i][1]);
            maxHeap.add(new Tuple(i, delta));
        }

        for (int i = 0; i < extraStudents; i++) {
            Tuple top = maxHeap.poll();
            if (top == null) {
                break;
            }
            classes[top.id][0] = classes[top.id][0] + 1;
            classes[top.id][1] = classes[top.id][1] + 1;
            double delta = ((double) (classes[top.id][0] + 1) / (classes[top.id][1] + 1)) - ((double) classes[top.id][0] / classes[top.id][1]);
            maxHeap.add(new Tuple(top.id, delta));
        }

        double totalRate = 0;
        for (int[] aClass : classes) {
            totalRate += (double) aClass[0] / (double) aClass[1];
        }
        return totalRate / classes.length;
    }

    public static void main(String[] args) {
        LC1792_MaximumAveragePassRatio solution = new LC1792_MaximumAveragePassRatio();
        int[][] classes = {{427, 850}, {577, 952}, {590, 953}, {367, 712}, {871, 911}, {65, 377}, {739, 803}, {202, 226}, {97, 131}, {618, 953}, {284, 876}, {356, 724}, {767, 948}, {336, 435}, {271, 423}, {364, 677}, {77, 234}, {466, 829}, {225, 646}, {284, 649}, {11, 891}, {522, 614}, {327, 882}, {194, 957}, {967, 987}, {368, 946}, {588, 693}, {312, 384}, {202, 718}, {678, 1000}, {331, 360}, {567, 916}, {562, 938}, {275, 972}, {92, 417}, {196, 387}, {460, 755}, {592, 746}, {202, 836}, {222, 334}, {450, 491}, {6, 849}, {50, 307}, {130, 523}, {73, 399}, {301, 568}, {132, 596}, {330, 331}, {396, 898}, {488, 931}, {646, 686}, {150, 578}, {264, 837}, {226, 253}, {387, 729}, {378, 584}, {630, 633}, {549, 766}, {52, 309}, {475, 518}, {866, 948}, {353, 716}, {6, 661}, {153, 488}, {511, 778}, {20, 838}, {34, 401}, {671, 710}, {447, 948}, {753, 908}, {111, 857}, {210, 869}, {436, 702}, {737, 850}, {381, 442}, {394, 462}, {65, 436}, {187, 512}, {526, 704}, {220, 961}, {191, 993}, {103, 750}, {435, 805}, {226, 370}, {185, 395}, {712, 987}, {364, 598}, {613, 729}, {145, 379}, {551, 682}, {164, 966}, {818, 822}, {240, 263}, {254, 564}, {666, 817}, {885, 885}, {74, 840}, {82, 824}, {208, 577}, {448, 504}, {781, 952}, {40, 882}, {226, 330}, {77, 966}, {87, 440}, {187, 327}, {830, 984}, {242, 490}, {363, 994}, {760, 844}, {587, 606}, {204, 985}, {291, 831}, {172, 464}, {792, 949}, {740, 770}, {116, 698}, {29, 105}, {260, 547}, {313, 804}, {106, 737}, {291, 919}, {208, 927}, {474, 746}, {231, 759}, {30, 426}, {76, 798}, {349, 858}, {463, 477}, {463, 573}, {229, 656}, {283, 443}, {389, 614}, {852, 974}, {90, 589}, {409, 902}, {678, 937}, {103, 407}, {107, 374}, {842, 866}, {786, 907}, {360, 362}, {406, 489}, {499, 941}, {211, 955}, {221, 659}, {818, 843}, {145, 827}, {119, 212}, {754, 843}, {15, 588}, {736, 868}, {880, 937}, {189, 499}, {352, 925}, {258, 900}, {92, 319}, {216, 843}, {714, 796}, {639, 986}, {562, 786}, {145, 831}, {259, 676}, {729, 993}, {99, 245}, {583, 800}, {307, 985}, {427, 536}, {330, 867}, {569, 593}, {159, 366}, {471, 537}, {234, 518}, {321, 657}, {213, 568}, {762, 890}, {132, 337}, {557, 928}, {141, 405}, {736, 997}, {842, 856}, {834, 873}, {38, 289}, {31, 729}, {36, 852}, {417, 971}, {376, 865}, {44, 872}, {473, 514}, {593, 743}, {467, 702}, {517, 652}, {304, 557}, {409, 414}, {694, 769}, {260, 339}, {82, 499}, {21, 964}, {802, 998}, {154, 324}, {67, 672}, {56, 369}, {63, 653}, {330, 393}, {222, 892}, {143, 439}, {240, 931}, {291, 892}, {5, 349}, {218, 231}, {272, 415}, {308, 973}, {416, 482}, {500, 968}, {609, 798}, {478, 793}, {18, 271}, {460, 478}, {466, 949}, {437, 541}, {768, 815}, {224, 638}, {375, 611}, {448, 652}, {175, 973}, {179, 673}, {580, 829}, {469, 566}, {363, 638}, {24, 533}, {221, 903}, {114, 766}, {383, 745}, {42, 667}, {460, 725}, {67, 334}, {100, 644}, {94, 532}, {375, 946}, {235, 719}, {93, 341}, {133, 250}, {241, 360}, {252, 274}, {401, 522}, {38, 595}, {15, 267}, {743, 782}, {287, 511}, {120, 499}, {422, 688}, {100, 287}, {64, 859}, {353, 936}, {377, 500}, {550, 616}, {206, 271}, {439, 743}, {174, 392}, {581, 770}, {666, 969}, {72, 378}, {576, 859}, {289, 456}, {482, 914}, {762, 952}, {207, 378}, {338, 394}, {792, 848}, {378, 858}, {175, 906}, {371, 456}, {257, 559}, {131, 739}, {227, 762}, {164, 885}, {341, 681}, {3, 733}, {128, 143}, {206, 897}, {135, 573}, {52, 519}, {392, 776}, {133, 144}, {348, 484}, {99, 476}, {17, 399}, {150, 389}, {89, 765}, {619, 916}, {137, 912}, {88, 522}, {267, 304}, {155, 589}, {748, 842}, {342, 759}, {910, 998}, {703, 729}, {103, 593}, {88, 454}, {522, 785}, {667, 967}, {13, 935}, {198, 970}, {538, 791}, {369, 961}, {450, 709}, {118, 995}, {18, 194}, {601, 831}, {26, 809}, {701, 951}, {570, 852}, {107, 884}, {313, 647}, {22, 695}, {427, 945}, {564, 669}, {177, 837}, {554, 613}, {268, 612}, {737, 938}, {181, 840}, {24, 48}, {194, 578}, {178, 193}, {748, 941}, {124, 732}, {369, 652}, {50, 679}, {677, 728}, {317, 679}, {114, 612}, {172, 222}, {1, 52}, {240, 932}, {176, 432}, {240, 585}, {145, 998}, {6, 961}, {479, 524}, {33, 504}, {842, 972}, {152, 511}, {262, 910}, {476, 575}, {712, 798}, {365, 602}, {347, 622}, {680, 865}, {427, 475}, {242, 850}, {928, 984}, {764, 862}, {383, 888}, {478, 491}, {7, 507}, {193, 341}, {103, 197}, {343, 869}, {47, 478}, {783, 873}, {709, 916}, {192, 898}, {268, 697}, {249, 561}, {459, 736}, {132, 443}, {177, 796}, {606, 830}, {41, 523}, {584, 839}, {321, 834}, {495, 759}, {688, 940}, {720, 931}, {306, 566}, {261, 927}, {285, 542}, {386, 513}, {251, 977}, {535, 863}, {230, 352}, {316, 876}, {284, 585}, {327, 591}, {268, 390}, {249, 614}, {86, 630}, {508, 672}, {170, 968}, {843, 993}, {786, 830}, {382, 781}, {564, 688}, {164, 590}, {554, 896}, {84, 613}, {453, 957}, {489, 703}, {373, 950}, {77, 326}, {550, 840}, {222, 531}, {228, 682}, {709, 934}, {150, 938}, {352, 364}, {529, 554}, {525, 559}, {176, 921}, {170, 915}, {651, 899}, {197, 780}, {210, 601}, {212, 554}, {33, 582}, {425, 652}, {193, 994}, {421, 471}, {339, 697}, {30, 863}, {324, 840}, {130, 184}, {237, 917}, {429, 568}, {178, 499}, {122, 522}, {128, 844}, {101, 598}, {17, 635}, {183, 478}, {86, 899}, {91, 559}, {144, 716}, {14, 418}, {825, 833}, {285, 872}, {196, 354}, {862, 920}, {450, 669}, {652, 924}, {501, 790}, {475, 805}, {506, 616}, {479, 647}, {587, 864}, {105, 268}, {345, 349}, {66, 468}, {581, 700}, {398, 898}, {288, 404}, {70, 340}, {141, 310}, {266, 667}, {21, 685}, {151, 185}, {192, 634}, {392, 882}, {128, 946}, {254, 414}, {175, 732}, {299, 355}, {542, 636}, {132, 408}, {118, 931}, {631, 950}, {372, 390}, {14, 234}, {105, 218}, {705, 776}, {81, 391}, {30, 584}, {363, 376}, {120, 396}, {142, 629}, {170, 769}, {215, 223}, {477, 966}, {226, 543}, {186, 473}, {264, 496}, {231, 401}, {20, 949}, {13, 127}, {52, 178}, {240, 327}, {324, 972}, {874, 928}, {110, 428}, {143, 484}, {653, 837}, {41, 280}, {366, 592}, {215, 711}, {352, 554}, {141, 508}, {290, 737}, {298, 977}, {23, 373}, {507, 883}, {30, 779}, {616, 807}, {238, 238}, {52, 573}, {560, 677}, {185, 302}, {497, 835}, {302, 563}, {71, 197}, {127, 190}, {582, 910}, {6, 329}, {136, 518}, {762, 919}, {152, 763}, {53, 201}, {173, 862}, {230, 844}, {155, 894}, {230, 674}, {547, 662}, {249, 930}, {256, 736}, {586, 760}, {294, 932}, {530, 631}, {434, 962}, {240, 863}, {580, 738}, {153, 388}, {601, 681}, {694, 738}, {600, 779}, {129, 946}, {180, 678}, {394, 396}, {160, 516}, {943, 991}, {119, 676}, {542, 583}, {131, 555}, {198, 680}, {171, 906}, {237, 496}, {68, 481}, {332, 987}, {61, 920}, {129, 509}, {148, 457}, {518, 876}, {788, 867}, {407, 549}, {402, 856}, {115, 955}, {815, 994}, {32, 906}, {169, 903}, {200, 627}, {255, 579}, {274, 640}, {286, 390}, {38, 44}, {457, 493}, {657, 991}, {83, 795}, {443, 777}, {136, 907}, {446, 886}, {218, 866}, {19, 636}, {2, 275}, {24, 767}, {156, 243}, {735, 878}, {210, 690}, {484, 587}, {273, 660}, {164, 514}, {197, 760}, {283, 382}, {399, 636}, {17, 826}, {385, 799}, {74, 785}, {557, 897}, {445, 755}, {2, 303}, {122, 307}, {201, 995}, {127, 485}, {368, 666}, {228, 674}, {632, 914}, {169, 887}, {9, 626}, {658, 988}, {386, 395}, {47, 592}, {163, 651}, {554, 895}, {158, 927}, {260, 648}, {492, 620}, {978, 994}, {404, 740}, {102, 140}, {369, 767}, {458, 627}, {252, 288}, {191, 620}, {172, 460}, {662, 958}, {200, 456}, {405, 998}, {72, 656}, {197, 720}, {828, 904}, {191, 440}, {53, 449}, {50, 77}, {678, 892}, {158, 918}, {147, 858}, {195, 444}, {401, 619}, {102, 540}, {329, 447}, {802, 938}, {679, 843}, {804, 995}, {776, 829}, {593, 919}, {291, 394}, {195, 705}, {45, 431}, {34, 775}, {258, 335}, {387, 509}, {89, 301}, {333, 842}, {795, 809}, {145, 580}, {55, 86}, {59, 188}, {504, 841}, {347, 434}, {43, 754}, {456, 912}, {125, 921}, {499, 750}, {208, 261}, {172, 387}, {229, 441}, {757, 881}, {376, 398}, {717, 777}, {101, 716}, {482, 628}, {411, 910}, {335, 810}, {670, 738}, {881, 984}, {768, 931}, {653, 697}, {57, 235}, {80, 272}, {59, 756}, {219, 587}, {220, 444}, {562, 640}, {201, 749}, {38, 988}, {68, 316}, {658, 774}, {70, 638}, {4, 544}, {684, 999}, {27, 832}, {694, 771}, {149, 828}, {162, 462}, {51, 655}, {48, 896}, {669, 880}, {246, 787}, {202, 230}, {32, 561}, {250, 464}, {235, 435}, {149, 664}, {59, 376}, {537, 563}, {365, 446}, {36, 993}, {830, 932}, {368, 765}, {9, 226}, {491, 585}, {413, 997}, {221, 708}, {288, 482}, {174, 951}, {378, 873}, {299, 667}, {110, 917}, {7, 811}, {537, 597}, {411, 557}, {403, 571}, {581, 609}, {601, 881}, {643, 892}, {114, 134}, {168, 738}, {285, 651}, {369, 985}, {47, 794}, {291, 824}, {199, 394}, {652, 877}, {645, 925}, {77, 846}, {471, 990}, {875, 978}, {50, 158}, {52, 700}, {160, 994}, {144, 946}, {465, 964}, {177, 929}, {153, 886}, {884, 976}, {177, 581}, {144, 322}, {242, 590}, {128, 624}, {259, 371}, {50, 114}, {123, 181}, {56, 635}, {779, 914}, {245, 716}, {49, 308}, {145, 560}, {7, 705}, {179, 679}, {469, 956}, {33, 442}, {14, 126}, {82, 185}, {41, 805}, {47, 345}, {490, 852}, {622, 973}, {461, 802}, {278, 763}, {494, 569}, {104, 865}, {521, 924}, {700, 811}, {576, 815}, {255, 628}, {229, 319}, {565, 782}, {424, 492}, {24, 304}, {592, 795}, {494, 733}, {207, 449}, {683, 742}, {403, 839}, {152, 930}, {182, 828}, {68, 180}, {326, 848}, {224, 512}, {5, 711}, {101, 352}, {758, 835}, {829, 937}, {31, 906}, {528, 941}, {325, 640}, {256, 684}, {812, 988}, {133, 206}, {539, 632}, {216, 357}, {749, 884}, {343, 874}, {164, 778}, {425, 857}, {453, 712}, {174, 403}, {371, 383}, {312, 793}, {200, 272}, {932, 991}, {814, 988}, {120, 363}, {364, 629}, {676, 714}, {170, 753}, {152, 591}, {283, 836}, {180, 965}, {539, 541}, {269, 581}, {230, 251}, {477, 648}, {212, 670}, {257, 691}, {278, 696}, {670, 685}, {323, 504}, {176, 950}, {318, 378}, {5, 671}, {13, 544}, {391, 614}, {419, 774}, {291, 717}, {963, 967}, {149, 364}, {132, 928}, {585, 698}, {87, 120}, {589, 589}, {91, 637}, {107, 782}, {185, 836}, {230, 370}, {861, 906}, {57, 226}, {379, 985}, {422, 426}, {561, 800}, {260, 449}, {400, 863}, {670, 829}, {14, 938}, {546, 744}, {685, 948}, {354, 722}, {772, 777}, {471, 725}, {396, 588}, {74, 367}, {595, 917}, {109, 650}, {359, 458}, {119, 290}, {433, 796}, {296, 806}, {493, 694}, {444, 471}, {148, 194}, {810, 844}, {384, 611}, {194, 765}, {144, 410}, {327, 531}, {33, 173}, {109, 539}, {79, 650}, {638, 718}, {215, 938}, {15, 641}, {497, 807}, {321, 482}, {846, 876}, {432, 884}, {177, 615}, {339, 744}, {250, 864}, {33, 794}, {302, 862}, {87, 957}, {26, 36}, {6, 690}, {458, 762}, {226, 639}, {323, 327}, {330, 620}, {99, 135}, {296, 826}, {272, 977}};
        int extraStudents = 91666;
        double result = solution.maxAverageRatio(classes, extraStudents);
        System.out.println(result);
    }
}

